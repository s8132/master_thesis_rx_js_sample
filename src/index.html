<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Przykłady programowania rekatywnego przy wykorzystaniu biblioteki RxJs</title>

    <link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../bower_components/highlightjs/styles/monokai-sublime.css">

    <script src="../bower_components/rxjs/dist/rx.all.js"></script>
    <script src="../bower_components/highlightjs/highlight.pack.min.js"></script>
    <style>
        pre{
            padding: 0;
            background-color: transparent;
            border: none;
            border-radius: none;
        }
    </style>
</head>
<body>
    <section class="container">
        <h1 class="page-header">
            Przykłady programowania reaktywnego po stronie klienta przy wykorzystaniu biblioteki RxJs
        </h1>
        <h2>Zliczanie kliknięć</h2>
        <div class="row">
            <div class="col-lg-6">
                <h4>Przykład działania</h4>
                <a id="button" class="btn btn-primary btn-block">Kliknij mnie raz lub szybko wielektorotnie</a>
                <div class="row">
                    <div class="col-lg-6">
                        <p>Ilość kliknięć</p>
                        <div class="well" id="click-counter-result"></div>
                    </div>
                    <div class="col-lg-6">
                        <p>Typ ostatniego kliknięcia</p>
                        <div class="well" id="click-type-result"></div>
                    </div>
                </div>
                <script>
                    var clickStream = Rx.Observable.fromEvent(document.querySelector('#button'), 'click');
//                    var clickCounter = clickStream
//                            .map(function() { return 1; })
//                            .scan(function(acc, seed){return seed + acc;});
                    var typeCounter = clickStream
                            .buffer(function(){ return clickStream.throttle(250); })
                            .map(function(list){ return list.length; })
                            .filter(function(length){ return length>=2 });

//                    clickCounter.subscribe(function (event) {
//                        document.querySelector('#click-counter-result').textContent = event + 'x kliknięć';
//                    });

                    typeCounter.subscribe(function (event) {

                        document.querySelector('#click-type-result').textContent = 'po ' + event + 'x click';
                    });

                    var multiClickStream = clickStream
                            .buffer(function() { return clickStream.throttle(250); })
                            .map(function(list) { return list.length; })
                            .filter(function(x) { return x > 0; });

                    multiClickStream.subscribe(function (numclicks) {
                        console.log("dasfasdfdf");
                        console.log(numclicks);
//                        document.querySelector('h2').textContent = ''+numclicks+'x click';
                    });
                </script>
            </div>
            <div class="col-lg-6">
                <h4>Przykładowy kod</h4>
            </div>
        </div>
        <h2>Binding</h2>
        <div class="row">
            <div class="col-lg-6">
                <h4>Przykład działania</h4>
                <form class="form">
                    <div class="form-group">
                        <label>Imię</label>
                        <input id="firstName" type="text" class="form-control" placeholder="Tutaj wpisz swoje imię">
                    </div>
                    <div class="form-group">
                        <label>Naziwsko</label>
                        <input id="lastName" type="text" class="form-control" placeholder="Tutaj wpisz swoje nazwisko">
                    </div>
                    <div class="form-group">
                        <label>Pełna nazwa</label>
                        <input id="fullName" type="text" class="form-control" readonly>
                    </div>
                </form>
                <script>
                    var firstName = new Rx.BehaviorSubject('');
                    var lastName = new Rx.BehaviorSubject('');
                    var fullName = firstName.combineLatest(lastName, function(first, last){
                        return first + ' ' + last;
                    });

                    Rx.Observable.fromEvent(document.querySelector("#firstName"), 'keyup').subscribe(function(event){
                        firstName.onNext(event.target.value);
                    });
                    Rx.Observable.fromEvent(document.querySelector("#lastName"), 'keyup').subscribe(function(event){
                        lastName.onNext(event.target.value);
                    });

                    fullName.subscribe(function(text){
                        document.querySelector("#fullName").value = text;
                    });
                </script>
            </div>
            <div class="col-lg-6">
                <h4>Przykładowy kod</h4>
                <pre>
                    <code class="js">
var firstName = new Rx.BehaviorSubject('');
var lastName = new Rx.BehaviorSubject('');
var fullName = firstName
                .combineLatest(lastName, function(first, last){
                    return first + ' ' + last;
                });

Rx.Observable
    .fromEvent(document.querySelector("#firstName"), 'keyup')
        .subscribe(function(event){
            firstName.onNext(event.target.value);
        });

Rx.Observable
    .fromEvent(document.querySelector("#lastName"), 'keyup')
        .subscribe(function(event){
            lastName.onNext(event.target.value);
        });

fullName.subscribe(function(text){
    document.querySelector("#fullName").value = text;
});
                    </code>
                </pre>
            </div>
        </div>
        <h2>Ajax</h2>
    </section>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>
</body>
</html>